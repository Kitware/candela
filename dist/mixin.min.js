!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("candela"),require("datalib"),require("d3-selection"),require("javascript-detect-element-resize/detect-element-resize"),require("telegraph-events"),require("vega")):"function"==typeof define&&define.amd?define(["candela","datalib","d3-selection","javascript-detect-element-resize/detect-element-resize","telegraph-events","vega"],t):"object"==typeof exports?exports.candela=t(require("candela"),require("datalib"),require("d3-selection"),require("javascript-detect-element-resize/detect-element-resize"),require("telegraph-events"),require("vega")):e.candela=t(e.candela,e.datalib,e["d3-selection"],e["javascript-detect-element-resize/detect-element-resize"],e["telegraph-events"],e.vega)}(this,function(e,t,n,r,i,o){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}({0:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var i=n(2),o=r(i),a=n(25),u=r(a),l=n(16),c=r(l),f=n(17),s=r(f),g=n(18),p=r(g),h=n(26),d=r(h),m={AutoResize:u.default,Events:c.default,InitSize:s.default,Resize:p.default,VegaChart:d.default};Object.entries(m).forEach(function(e){return o.default.registerMixin(e[1],e[0])})},2:function(t,n){t.exports=e},6:function(e,n){e.exports=t},10:function(e,t){e.exports=n},11:function(e,t){"use strict";function n(e){var t=window.getComputedStyle(e,null),n=window.parseInt(t.getPropertyValue("width")),r=window.parseInt(t.getPropertyValue("height"));return{width:n,height:r}}function r(e){var t={min:null,max:null};if(e.length>0){t.min=t.max=e[0];var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var u=o.value;u<t.min&&(t.min=u),u>t.max&&(t.max=u)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getElementSize=n,t.minmax=r},16:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=n(88),l=r(u),c=function(e){return function(e){function t(){var e;i(this,t);for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];var u=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return(0,l.default)(u),u}return a(t,e),t}(e)};t.default=c},17:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(11),u=function(e){return function(e){function t(){var e;r(this,t);for(var n=arguments.length,o=Array(n),u=0;u<n;u++)o[u]=arguments[u];var l=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),c=(0,a.getElementSize)(l.el);return l.width=c.width,l.height=c.height,l}return o(t,e),t}(e)};t.default=u},18:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),n(82);var u=n(16),l=r(u),c=n(11),f=function(e){return function(e){function t(){var e;i(this,t);for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];var u=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return window.addResizeListener(u.el,function(){var e=(0,c.getElementSize)(u.el);u.emit("resize",e.width,e.height,u)}),u}return a(t,e),t}((0,l.default)(e))};t.default=f},25:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=n(18),l=r(u),c=n(17),f=r(c),s=function(e){return function(e){function t(){var e;i(this,t);for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];var u=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return u.on("resize",function(e,t){u.width=e,u.height=t,u.render()}),u}return a(t,e),t}((0,l.default)((0,f.default)(e)))};t.default=s},26:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(50),c=r(l),f=function(e,t){return function(e){function n(){var e;i(this,n);for(var r=arguments.length,a=Array(r),u=0;u<r;u++)a[u]=arguments[u];var l=o(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(a)));return l.options=a[1],l.chart=c.default.parseChart(t,l.el,l.options),l}return a(n,e),u(n,[{key:"render",value:function(){var e=this;return this.chart.then(function(t){e.width&&(t=t.width(e.width)),e.height&&(t=t.height(e.height)),t.update()})}},{key:"update",value:function(e){var t=this,n=this.chart;return Object.assign(this.options,e),this.options.data&&(n=n.then(function(e){return e.data("data").remove(function(){return!0}).insert(t.options.data)})),this.options.width&&(this.width=this.options.width),this.options.height&&(this.height=this.options.height),n}},{key:"destroy",value:function(){this.empty(),delete this.chart}},{key:"serialize",value:function(e){return this.chart?this.chart.then(function(t){return t.toImageURL(e)}):Promise.reject("The render() method must be called before serialize().")}},{key:"serializationFormats",get:function(){return["png","svg"]}}]),n}(e)};t.default=f},50:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(10),a=n(89),u=r(a),l=n(6),c=n(70),f=r(c),s=n(11),g=function e(t,n){return void 0===t||0===n.length?t:e(t[n[0]],n.slice(1))},p=function(e,t){return g(e,t.split("."))},h=function e(t,n,r){return 1===n.length?void(t[n[0]]=r):(void 0===t[n[0]]&&(t[n[0]]={}),void e(t[n[0]],n.slice(1),r))},d=function(e,t,n){h(e,t.split("."),n)},m={defaults:function(e,t,n){for(var r=0;r<e[0].length;r+=1){var i=y(e[0][r][0],t,n),o=p(n,i);void 0===o&&(o=p(t,i)),void 0===o&&(o=y(e[0][r][1],t,n),d(n,i,o))}return y(e[1],t,n)},let:function(e,t,n){for(var r=0;r<e[0].length;r+=1){var i=y(e[0][r][0],t,n),o=y(e[0][r][1],t,n);d(n,i,o)}return y(e[1],t,n)},get:function(e,t,n){var r=y(e[0],t,n),i=p(n,r);return void 0===i&&(i=p(t,r)),void 0===i&&(i=y(e[1],t,n)),void 0===i&&(i=null),i},map:function(e,t,n){var r=[],i=y(e[0],t,n);if(!Array.isArray(i))return r;for(var o=0;o<i.length;o+=1){n[e[1]]=i[o],n.index=o;for(var a=2;a<e.length;a+=1){var u=y(e[a],t,n);null!==u&&r.push(u)}}return r},if:function(e,t,n){var r=y(e[0],t,n);return r?y(e[1],t,n):y(e[2],t,n)},eq:function(e,t,n){var r=y(e[0],t,n),i=y(e[1],t,n);return r===i},lt:function(e,t,n){var r=y(e[0],t,n),i=y(e[1],t,n);return r<i},gt:function(e,t,n){var r=y(e[0],t,n),i=y(e[1],t,n);return r>i},length:function(e,t,n){var r=y(e[0],t,n);return(0,l.isArray)(r)||(0,l.isString)(r)?r.length:0},and:function(e,t,n){for(var r=y(e,t,n),i=0;i<r.length;i+=1)if(!r[i])return!1;return!0},or:function(e,t,n){for(var r=y(e,t,n),i=0;i<r.length;i+=1)if(r[i])return!0;return!1},mult:function(e,t,n){for(var r=y(e,t,n),i=1,o=0;o<r.length;o+=1)i*=r[o];return i},add:function(e,t,n){for(var r=y(e,t,n),i=0,o=0;o<r.length;o+=1)i+=r[o];return i},join:function(e,t,n){var r="",i=y(e[0],t,n),o=y(e[1],t,n);if(!Array.isArray(o))return r;for(var a=0;a<o.length;a+=1)a>0&&(r+=i),r+=o[a];return r},merge:function(e,t,n){for(var r=y(e[0],t,n),i=1;i<e.length;i+=1)r=S(r,y(e[i],t,n));return r},colorScale:function(e,t,n){var r=y(e[0],t,n),i=r.name||"color";return!Array.isArray(r.values)||r.values.length<1||void 0===r.values[0][r.field]||"string"==typeof r.values[0][r.field]?{name:i,type:"ordinal",domain:{data:r.data,field:r.field},range:"category10"}:{name:i,type:"linear",zero:!1,domain:{data:r.data,field:r.field},range:["#df2709","#2709df"]}},axis:function(e,t,n){var r=y(e[0],t,n);if(r.data&&Array.isArray(r.data)&&r.field){r.data.__types__||(0,l.read)(r.data,{parse:"auto"});var i=r.data.__types__[r.field];"string"===i?r.formatType="string":"date"===i?(r.type=r.type||"time",r.formatType="time",r.format="%Y-%m-%d"):(r.formatType="number",r.format="s")}return y(f.default,r)},isStringField:function(e,t,n){var r=y(e[0],t,n),i=y(e[1],t,n);return!Array.isArray(r)||r.length<1||void 0===r[0][i]||"string"==typeof r[0][i]},orient:function(e,t,n){var r=y(e[0],t,n),i=y(e[1],t,n),o={},a={x:"y",x2:"y2",xc:"yc",y:"x",y2:"x2",yc:"xc",width:"height",height:"width"};if("horizontal"===r)return i;for(var u in i)i.hasOwnProperty(u)&&(a[u]?o[a[u]]=i[u]:o[u]=i[u]);return o}},y=function e(t,n,r){if(n=n||{},r=r||{},Array.isArray(t)){if(t.length>0&&"string"==typeof t[0]&&"@"===t[0].slice(0,1))return m[t[0].slice(1)](t.slice(1),n,r);for(var o=[],a=0;a<t.length;a+=1)o.push(e(t[a],n,r));return o}if(null===t)return t;if(t instanceof Date)return t;if("object"===("undefined"==typeof t?"undefined":i(t))){var u={};for(var l in t)t.hasOwnProperty(l)&&(u[l]=e(t[l],n,r));return u}return t},v=function(e){return e&&e.constructor&&"Object"===e.constructor.name},b=function(e){return e&&e.constructor&&"Array"===e.constructor.name},x=function e(t,n){if(void 0===n)return t;if(v(t)){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e(t[i],n[i]));for(var o in n)Object.prototype.hasOwnProperty.call(t,o)||(r[o]=n[o]);return r}if(b(t)){for(var a=[],u=0;u<t.length;u+=1)a.push(e(t[u],n[u]));if(b(n))for(var l=t.length;l<n.length;l+=1)a.push(n[l]);return a}return n},S=function e(t,n){if(void 0===n||null===n)return t;if(void 0===t||null===t)return n;if(v(t)){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e(t[i],n[i]));for(var o in n)Object.prototype.hasOwnProperty.call(r,o)||(r[o]=n[o]);return r}if(b(t)){for(var a=[],u=0;u<t.length;u+=1)a.push(t[u]);if(b(n))for(var l=0;l<n.length;l+=1)a.push(n[l]);return a}return t},w=function(e,t,n){var r=(0,o.select)(t).node(),i={},a=(0,s.getElementSize)(r),l=a.width,c=a.height;0!==l&&0!==c&&(void 0===n.width&&(i.width=l),void 0===n.height&&(i.height=c));var f=x(n,i),g={el:r,renderer:f.renderer},p=y(e,f);return new Promise(function(e){u.default.parse.spec(p,function(t){var n=t(g);n.update(),e(n)})})};t.default={transform:y,parseChart:w}},70:function(e,t){e.exports=["@let",[["event",["@if",["@eq",["@get","axis"],"x"],"eventX()","eventY()"]],["sizeSignal",["@if",["@eq",["@get","axis"],"x"],"width","height"]],["pointSignal",["@join","",[["@get","axis"],"point"]]],["deltaSignal",["@join","",[["@get","axis"],"delta"]]],["anchorSignal",["@join","",[["@get","axis"],"anchor"]]],["zoomSignal",["@join","",[["@get","axis"],"zoom"]]],["minAnchorSignal",["@join","",[["@get","axis"],"minanchor"]]],["maxAnchorSignal",["@join","",[["@get","axis"],"maxanchor"]]],["minSignal",["@join","",[["@get","axis"],"min"]]],["maxSignal",["@join","",[["@get","axis"],"max"]]]],{signals:[{name:["@get","pointSignal"],init:0,streams:[{type:"mousedown",expr:["@get","event"]}]},{name:["@get","deltaSignal"],init:0,streams:[{type:"[mousedown, window:mouseup] > window:mousemove",expr:["@join","",["@if",["@eq",["@get","axis"],"x"],[["@get","pointSignal"]," - ",["@get","event"]],[["@get","event"]," - ",["@get","pointSignal"]]]]}]},{name:["@get","anchorSignal"],init:0,streams:[{type:"mousemove, wheel",expr:["@get","event"],scale:{name:["@get","axis"],invert:!0}}]},{name:["@get","zoomSignal"],init:1,streams:[{type:"wheel",expr:"pow(1.001, event.deltaY)"}]},{name:["@get","minAnchorSignal"],streams:[{type:"mousedown, mouseup, wheel",expr:["@if",["@eq",["@get","axis"],"x"],"0",["@get","sizeSignal"]],scale:{name:["@get","axis"],invert:!0}}]},{name:["@get","maxAnchorSignal"],streams:[{type:"mousedown, mouseup, wheel",expr:["@if",["@eq",["@get","axis"],"x"],["@get","sizeSignal"],"0"],scale:{name:["@get","axis"],invert:!0}}]},{name:["@get","minSignal"],init:["@get","domain.0",null],streams:[{type:["@get","deltaSignal"],expr:["@if",["@get","pan",!0],["@if",["@eq",["@get","type"],"time"],["@join","",["time(",["@get","minAnchorSignal"],") + (time(",["@get","maxAnchorSignal"],")-time(",["@get","minAnchorSignal"],"))*",["@get","deltaSignal"],"/",["@get","sizeSignal"]]],["@join","",[["@get","minAnchorSignal"]," + (",["@get","maxAnchorSignal"],"-",["@get","minAnchorSignal"],")*",["@get","deltaSignal"],"/",["@get","sizeSignal"]]]],["@get","minAnchorSignal"]]},{type:["@get","zoomSignal"],expr:["@if",["@get","zoom",!0],["@if",["@eq",["@get","type"],"time"],["@join","",["(time(",["@get","minAnchorSignal"],")-time(",["@get","anchorSignal"],"))*",["@get","zoomSignal"]," + time(",["@get","anchorSignal"],")"]],["@join","",["(",["@get","minAnchorSignal"],"-",["@get","anchorSignal"],")*",["@get","zoomSignal"]," + ",["@get","anchorSignal"]]]],["@get","minAnchorSignal"]]}]},{name:["@get","maxSignal"],init:["@get","domain.1",null],streams:[{type:["@get","deltaSignal"],expr:["@if",["@get","pan",!0],["@if",["@eq",["@get","type"],"time"],["@join","",["time(",["@get","maxAnchorSignal"],") + (time(",["@get","maxAnchorSignal"],")-time(",["@get","minAnchorSignal"],"))*",["@get","deltaSignal"],"/",["@get","sizeSignal"]]],["@join","",[["@get","maxAnchorSignal"]," + (",["@get","maxAnchorSignal"],"-",["@get","minAnchorSignal"],")*",["@get","deltaSignal"],"/",["@get","sizeSignal"]]]],["@get","maxAnchorSignal"]]},{type:["@get","zoomSignal"],expr:["@if",["@get","zoom",!0],["@if",["@eq",["@get","type"],"time"],["@join","",["(time(",["@get","maxAnchorSignal"],")-time(",["@get","anchorSignal"],"))*",["@get","zoomSignal"]," + time(",["@get","anchorSignal"],")"]],["@join","",["(",["@get","maxAnchorSignal"],"-",["@get","anchorSignal"],")*",["@get","zoomSignal"]," + ",["@get","anchorSignal"]]]],["@get","maxAnchorSignal"]]}]}],scales:[{name:["@get","axis"],type:["@get","type","linear"],range:["@get","sizeSignal"],points:["@get","points",!1],zero:["@get","zero",!1],nice:["@get","nice",!1],round:["@get","round",!1],padding:["@get","padding",0],domain:["@get","domain"],domainMin:{signal:["@get","minSignal"]},domainMax:{signal:["@get","maxSignal"]}}],axes:[{type:["@get","axis"],scale:["@get","axis"],grid:["@get","grid",!1],layer:"back",title:["@get","title",""],formatType:["@get","formatType"],format:["@get","format"],properties:["@get","properties",{}]}]}]},82:function(e,t){e.exports=r},88:function(e,t){e.exports=i},89:function(e,t){e.exports=o}})});