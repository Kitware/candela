!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("candela/VisComponent"),require("candela"),require("d3"),require("candela/util"),require("geojs")):"function"==typeof define&&define.amd?define(["candela/VisComponent","candela","d3","candela/util","geojs"],t):"object"==typeof exports?exports.candela=t(require("candela/VisComponent"),require("candela"),require("d3"),require("candela/util"),require("geojs")):e.candela=t(e["candela/VisComponent"],e.candela,e.d3,e["candela/util"],e.geojs)}(this,function(e,t,r,o,n){return function(e){function t(o){if(r[o])return r[o].exports;var n=r[o]={exports:{},id:o,loaded:!1};return e[o].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}({0:function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}var n=r(2),a=o(n),i=r(15),u=o(i),l=r(22),s=o(l),f={Geo:u.default,GeoDots:s.default};Object.entries(f).forEach(function(e){return a.default.register(e[1],e[0])})},1:function(t,r){t.exports=e},2:function(e,r){e.exports=t},3:function(e,t){e.exports=r},12:function(e,t){e.exports=o},15:function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),l=r(80),s=o(l),f=r(1),c=o(f),d=function(e){function t(e,r){var o=r.map,i=void 0===o?{}:o,u=r.layers,l=void 0===u?[]:u,f=r.width,c=r.height;n(this,t);var d=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return f=f||i.width||600,c=c||i.height||600,e.style.width=f+"px",e.style.height=c+"px",d.plot=s.default.map(Object.assign({node:e},i)),d.layers=[],l.forEach(function(e){switch(e.type){case"osm":d.layers.push(d.plot.createLayer("osm",e));break;case"feature":e.features.forEach(function(e){var t=d.plot.createLayer("feature",{renderer:"d3"}).createFeature(e.type).data(e.data).position(function(t){return{x:t[e.x],y:t[e.y]}}),r=Object.assign({fillColor:"red",strokeColor:"darkred"},e.style);t.style(r),d.layers.push(t)})}}),d.render(),d}return i(t,e),u(t,[{key:"render",value:function(){this.plot.draw()}}]),t}(c.default);t.default=d},22:function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=r(3),f=o(s),c=r(15),d=o(c),p=r(1),y=o(p),m=r(12),b=function(e,t){var r=5;if(t){var o=(0,m.minmax)(e.map(function(e){return e[t]})),n=f.default.scale.linear().domain([o.min,o.max]).range([3,19]);r=function(e){return n(e[t])}}return r},h=function(e,t){var r="red",o="darkred";if(t&&e.length>0){var n=void 0,a=void 0,i=l(e[0][t]);if(void 0===i||"string"===i)n=f.default.scale.category10(),a="black";else{var u=(0,m.minmax)(e.map(function(e){return e[t]})),s=f.default.rgb("#ef6a62"),c=f.default.rgb("#67a9cf"),d=s.darker(),p=c.darker();n=f.default.scale.linear().domain([u.min,u.max]).range([s,c]),a=f.default.scale.linear().domain([u.min,u.max]).range([d,p])}r=function(e){return n(e[t])},o="black"===a?"black":function(e){return a(e[t])}}return{fillTransform:r,strokeTransform:o}},g=function(e){function t(e,r){n(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),i=r.width||600,u=r.height||600;e.style.width=i+"px",e.style.height=u+"px";var l=b(r.data,r.size),s=h(r.data,r.color),f=s.fillTransform,c=s.strokeTransform;r.layers=[],null!==r.tileUrl&&r.layers.push({type:"osm",url:r.tileUrl}),r.layers.push({type:"feature",features:[{name:"feature1",type:"point",x:r.longitude,y:r.latitude,style:{radius:l,fillColor:f,strokeColor:c},data:r.data}]}),r.center=r.center||{};var p={x:r.center.longitude||0,y:r.center.latitude||0},y=Object.assign({map:{zoom:r.zoom,center:p}},r);return o.geojs=new d.default(o.el,y),o.options=r,o}return i(t,e),u(t,null,[{key:"options",get:function(){return[{name:"data",type:"table",format:"objectlist"},{name:"latitude",type:"string",format:"text",domain:{mode:"field",from:"data",fieldTypes:["number"]}},{name:"longitude",type:"string",format:"text",domain:{mode:"field",from:"data",fieldTypes:["number"]}},{name:"color",type:"string",format:"text",optional:!0,domain:{mode:"field",from:"data",fieldTypes:["string","date","number","integer","boolean"]}},{name:"size",type:"string",format:"text",optional:!0,domain:{mode:"field",from:"data",fieldTypes:["number","integer","boolean"]}}]}}]),u(t,[{key:"render",value:function(){this.geojs.render()}},{key:"update",value:function(e){var t=this,r=this.geojs.layers[1],o=new Set;if(["longitude","latitude","color","size"].forEach(function(r){e[r]&&(o.add(r),t.options[r]=e[r])}),(o.has("longitude")||o.has("latitude"))&&r.position(function(e){return{x:e[t.options.longitude],y:e[t.options.latitude]}}),o.has("size")&&r.style("radius",b(this.options.data,this.options.size)),o.has("color")){var n=h(this.options.data,this.options.color),a=n.fillTransform,i=n.strokeTransform;r.style("fillColor",a).style("strokeColor",i)}return o.size>0&&r.modified(),Promise.resolve(this)}}]),t}(y.default);t.default=g},80:function(e,t){e.exports=n}})});